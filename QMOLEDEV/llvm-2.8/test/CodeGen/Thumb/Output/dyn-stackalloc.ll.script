set -o pipefail
'llc' '-march=thumb' < '/private/var/chris/llvm-2.8/test/CodeGen/Thumb/dyn-stackalloc.ll' |
  'not' 'grep' 'ldr sp'  &&

'llc' '-mtriple=thumb-apple-darwin' < '/private/var/chris/llvm-2.8/test/CodeGen/Thumb/dyn-stackalloc.ll' |
  'not' 'grep' 'sub.*r7'  &&

'llc' '-march=thumb' < '/private/var/chris/llvm-2.8/test/CodeGen/Thumb/dyn-stackalloc.ll' |
  'grep' 'mov.*r6, sp'