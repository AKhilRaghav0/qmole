
<!--
  $Xorg: mkdepend.man,v 1.5 2001/02/09 02:03:16 xorgcvs Exp $
   Copyright (c) 1993, 1994, 1998 The Open Group
   
   Permission to use, copy, modify, distribute, and sell this software and its
   documentation for any purpose is hereby granted without fee, provided that
   the above copyright notice appear in all copies and that both that
   copyright notice and this permission notice appear in supporting
   documentation.
   
   The above copyright notice and this permission notice shall be included in
   all copies or substantial portions of the Software.
   
   THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
   IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
   FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL 
   THE OPEN GROUP BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, 
   WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF 
   OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE 
   SOFTWARE.
   
   Except as contained in this notice, the name of The Open Group shall not 
   be used in advertising or otherwise to promote the sale, use or other 
   dealing in this Software without prior written authorization from The
   Open Group.
   
   $XFree86: xc/config/makedepend/mkdepend.man,v 1.7 2002/12/14 02:39:45 dawes Exp $
   
 
-->
<!-- manual page source format generated by PolyglotMan v3.0.8+XFree86, -->
<!-- available via anonymous ftp from ftp.cs.berkeley.edu:/ucb/people/phelps/tcltk/rman.tar.Z -->

<HTML>
<HEAD>
<TITLE>MAKEDEPEND(1) manual page</TITLE>
</HEAD>
<BODY BGCOLOR="#efefef" TEXT="black" LINK="blue" VLINK="#551A8B" ALINK="red">
<A HREF="#toc">Table of Contents</A><P>
 
<H2><A NAME="sect0" HREF="#toc0">Name</A></H2>
makedepend - create dependencies in makefiles

<H2><A NAME="sect1" HREF="#toc1">Synopsis</A></H2>
<B>makedepend</B> [ <B>-D</B><I>name<B>=</B>def</I> ] [ <B>-D</B><I>name</I> ] [ <B>-I</B><I>includedir</I> ] [ <B>-Y</B><I>includedir</I>
] [ <B>-a</B> ] [ <B>-f</B><I>makefile</I> ] [ <B>-include</B><I>&nbsp;file</I> ] [ <B>-o</B><I>objsuffix</I> ] [ <B>-p</B><I>objprefix</I> ] [ <B>-s</B><I>string</I>
] [ <B>-w</B><I>width</I> ] [ <B>-v</B> ] [ <B>-m</B> ] [ -- <I>otheroptions</I> -- ] <I>sourcefile</I> ... <BR>

<H2><A NAME="sect2" HREF="#toc2">Description</A></H2>
The <B>makedepend</B> program reads each <I>sourcefile</I> in sequence and
parses it like a C-preprocessor, processing all <I>#include,</I> <I>#define,</I> <I>#undef,</I>
<I>#ifdef,</I> <I>#ifndef,</I> <I>#endif,</I> <I>#if,</I> <I>#elif</I> and <I>#else</I> directives so that it can
correctly tell which <I>#include,</I> directives would be used in a compilation.
Any <I>#include,</I> directives can reference files having other <I>#include</I> directives,
and parsing will occur in these files as well. <P>
Every file that a <I>sourcefile</I>
includes, directly or indirectly, is what <B>makedepend</B> calls a <I>dependency.</I>
These dependencies are then written to a <I>makefile</I> in such a way that <B><A HREF="make.1.html">make(1)</B></A>

will know which object files must be recompiled when a dependency has changed.
<P>
By default, <B>makedepend</B> places its output in the file named <I>makefile</I> if
it exists, otherwise <I>Makefile.</I> An alternate makefile may be specified with
the <B>-f</B> option. It first searches the makefile for the line <P>
 # DO NOT DELETE
THIS LINE -- make depend depends on it. <P>
or one provided with the <B>-s</B> option,
as a delimiter for the dependency output. If it finds it, it will delete
everything following this to the end of the makefile and put the output
after this line. If it doesn't find it, the program will append the string
to the end of the makefile and place the output following that. For each
<I>sourcefile</I> appearing on the command line, <B>makedepend</B> puts lines in the
makefile of the form <P>
     sourcefile.o: dfile ...<BR>
 <P>
Where <I>sourcefile.o</I> is the name from the command line with its suffix replaced
with ``.o'', and <I>dfile</I> is a dependency discovered in a <I>#include</I> directive while
parsing <I>sourcefile</I> or one of the files it included. 
<H2><A NAME="sect3" HREF="#toc3">Example</A></H2>
Normally, <B>makedepend</B>
will be used in a makefile target so that typing ``make depend'' will bring
the dependencies up to date for the makefile. For example, <BR>
<PRE>    SRCS = file1.c file2.c ...
    CFLAGS = -O -DHACK -I../foobar -xyz
    depend:
            makedepend -- $(CFLAGS) -- $(SRCS)
</PRE>
<H2><A NAME="sect4" HREF="#toc4">Options</A></H2>
The program will ignore any option that it does not understand so
that you may use the same arguments that you would for <B><A HREF="cc.1.html">cc(1)</A>
.</B> 
<DL>

<DT><B>-D<I>name</I>=<I>def</I>
or -D<I>name</I></B> </DT>
<DD>Define. This places a definition for <I>name</I> in <B>makedepend's</B> symbol
table. Without <I>=def</I> the symbol becomes defined as ``1''. </DD>

<DT><B>-I<I>includedir</I></B> </DT>
<DD>Include
directory. This option tells <B>makedepend</B> to prepend <I>includedir</I> to its list
of directories to search when it encounters a <I>#include</I> directive. By default,
<B>makedepend</B> only searches the standard include directories (usually /usr/include
and possibly a compiler-dependent directory). </DD>

<DT><B>-Y<I>includedir</I></B> </DT>
<DD>Replace all of
the standard include directories with the single specified include directory;
you can omit the <I>includedir</I> to simply prevent searching the standard include
directories. </DD>

<DT><B>-a</B> </DT>
<DD>Append the dependencies to the end of the file instead of
replacing them. </DD>

<DT><B>-f<I>makefile</I></B> </DT>
<DD>Filename. This allows you to specify an alternate
makefile in which <B>makedepend</B> can place its output. Specifying ``-'' as the file
name (i.e., <B>-f-</B>) sends the output to standard output instead of modifying an
existing file. </DD>

<DT><B>-include <I>file</I></B> </DT>
<DD>Process file as input, and include all the resulting
output before processing the regular input file. This has the same affect
as if the specified file is an include statement that appears before the
very first line of the regular input file. </DD>

<DT><B>-o<I>objsuffix</I></B> </DT>
<DD>Object file suffix.
Some systems may have object files whose suffix is something other than
``.o''. This option allows you to specify another suffix, such as ``.b'' with <I>-o.b</I> or
``:obj'' with <I>-o:obj</I> and so forth. </DD>

<DT><B>-p<I>objprefix</I></B> </DT>
<DD>Object file prefix. The prefix is
prepended to the name of the object file. This is usually used to designate
a different directory for the object file. The default is the empty string.
</DD>

<DT><B>-s<I>string</I></B> </DT>
<DD>Starting string delimiter. This option permits you to specify a
different string for <B>makedepend</B> to look for in the makefile. </DD>

<DT><B>-w<I>width</I></B> </DT>
<DD>Line
width. Normally, <B>makedepend</B> will ensure that every output line that it writes
will be no wider than 78 characters for the sake of readability. This option
enables you to change this width. </DD>

<DT><B>-v</B> </DT>
<DD>Verbose operation. This option causes
<B>makedepend</B> to emit the list of files included by each input file. </DD>

<DT><B>-m</B> </DT>
<DD>Warn
about multiple inclusion. This option causes <B>makedepend</B> to produce a warning
if any input file includes another file more than once. In previous versions
of <B>makedepend</B> this was the default behavior; the default has been changed
to better match the behavior of the C compiler, which does not consider
multiple inclusion to be an error. This option is provided for backward
compatibility, and to aid in debugging problems related to multiple inclusion.
</DD>

<DT><B>-- <I>options</I> --</B> </DT>
<DD>If <B>makedepend</B> encounters a double hyphen (--) in the argument list,
then any unrecognized argument following it will be silently ignored; a
second double hyphen terminates this special treatment. In this way, <B>makedepend</B>
can be made to safely ignore esoteric compiler arguments that might normally
be found in a CFLAGS <B>make</B> macro (see the <B>EXAMPLE</B> section above). All options
that <B>makedepend</B> recognizes and appear between the pair of double hyphens
are processed normally. </DD>
</DL>

<H2><A NAME="sect5" HREF="#toc5">Algorithm</A></H2>
The approach used in this program enables
it to run an order of magnitude faster than any other ``dependency generator''
I have ever seen. Central to this performance are two assumptions: that
all files compiled by a single makefile will be compiled with roughly the
same <I>-I</I> and <I>-D</I> options; and that most files in a single directory will include
largely the same files. <P>
Given these assumptions, <B>makedepend</B> expects to be
called once for each makefile, with all source files that are maintained
by the makefile appearing on the command line. It parses each source and
include file exactly once, maintaining an internal symbol table for each.
Thus, the first file on the command line will take an amount of time proportional
to the amount of time that a normal C preprocessor takes. But on subsequent
files, if it encounters an include file that it has already parsed, it
does not parse it again. <P>
For example, imagine you are compiling two files,
<I>file1.c</I> and <I>file2.c,</I> they each include the header file <I>header.h,</I> and the file
<I>header.h</I> in turn includes the files <I>def1.h</I> and <I>def2.h.</I> When you run the command
<P>
    makedepend file1.c file2.c<BR>
 <P>
<B>makedepend</B> will parse <I>file1.c</I> and consequently, <I>header.h</I> and then <I>def1.h</I>
and <I>def2.h.</I> It then decides that the dependencies for this file are <P>
    file1.o:
header.h def1.h def2.h<BR>
 <P>
But when the program parses <I>file2.c</I> and discovers that it, too, includes
<I>header.h,</I> it does not parse the file, but simply adds <I>header.h,</I> <I>def1.h</I> and
<I>def2.h</I> to the list of dependencies for <I>file2.o.</I> 
<H2><A NAME="sect6" HREF="#toc6">See Also</A></H2>
<A HREF="cc.1.html">cc(1)</A>
, <A HREF="make.1.html">make(1)</A>
 
<H2><A NAME="sect7" HREF="#toc7">Bugs</A></H2>
<B>makedepend</B>
parses, but does not currently evaluate, the SVR4 #predicate(token-list)
preprocessor expression; such expressions are simply assumed to be true.
This may cause the wrong <I>#include</I> directives to be evaluated. <P>
Imagine you
are parsing two files, say <I>file1.c</I> and <I>file2.c,</I> each includes the file <I>def.h.</I>
The list of files that <I>def.h</I> includes might truly be different when <I>def.h</I>
is included by <I>file1.c</I> than when it is included by <I>file2.c.</I> But once <B>makedepend</B>
arrives at a list of dependencies for a file, it is cast in concrete. 
<H2><A NAME="sect8" HREF="#toc8">Author</A></H2>
Todd
Brunhoff, Tektronix, Inc. and MIT Project Athena <P>

<HR><P>
<A NAME="toc"><B>Table of Contents</B></A><P>
<UL>
<LI><A NAME="toc0" HREF="#sect0">Name</A></LI>
<LI><A NAME="toc1" HREF="#sect1">Synopsis</A></LI>
<LI><A NAME="toc2" HREF="#sect2">Description</A></LI>
<LI><A NAME="toc3" HREF="#sect3">Example</A></LI>
<LI><A NAME="toc4" HREF="#sect4">Options</A></LI>
<LI><A NAME="toc5" HREF="#sect5">Algorithm</A></LI>
<LI><A NAME="toc6" HREF="#sect6">See Also</A></LI>
<LI><A NAME="toc7" HREF="#sect7">Bugs</A></LI>
<LI><A NAME="toc8" HREF="#sect8">Author</A></LI>
</UL>
</BODY></HTML>
